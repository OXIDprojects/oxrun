#!/usr/bin/env php
<?php

namespace Oxrun;

use Oxrun\CommandCollection\CommunityCollection;
use Oxrun\CommandCollection\OxrunCollection;
use Symfony\Component\Console\Output\ConsoleOutput;

// composer bin autoload
if (is_file(__DIR__ . '/../../../autoload.php')) {
    $OXRUN_VENDOR_PATH = __DIR__ . '/../../../';
}

// default autoload
if (is_file(__DIR__ . '/../vendor/autoload.php')) {
    $OXRUN_VENDOR_PATH = __DIR__ . '/../vendor/';
}

$autoloader = require_once $OXRUN_VENDOR_PATH . 'autoload.php';

$application = new \Oxrun\Application($autoloader, 'oxrun', '@package_version@');

try {
    (new CommunityCollection())->addCommandTo($application);
    (new OxrunCollection())->addCommandTo($application);
} catch (\Exception $e) {
    $consoleOutput = new ConsoleOutput();
    $consoleOutput->writeln('<comment>Command Collection: '.$e->getMessage().'</comment>');
}

$application->run();


__HALT_COMPILER();
